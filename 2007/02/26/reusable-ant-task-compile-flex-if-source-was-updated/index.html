
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Reusable Ant Task: Compile Flex If Source Was Updated - James Ward</title>
  <meta name="author" content="James Ward">

  
  <meta name="description" content="I&#8217;m working on a project that compiles 11 Flex applications. My Ant build file was getting pretty messy and I was continually commenting out &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://jamesward.github.com/2007/02/26/reusable-ant-task-compile-flex-if-source-was-updated">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="James Ward" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-784803-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">James Ward</a></h1>
  
    <h2>Heroku | Java | Scala | Cloud | Open Source | Linux</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:jamesward.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul class="main-navigation">
  <li><a href="/about-james-ward">About James Ward</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Reusable Ant Task: Compile Flex if Source Was Updated</h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-02-26T11:37:43-07:00" pubdate data-updated="true">Feb 26<span>th</span>, 2007</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>I&#8217;m working on a project that compiles 11 Flex applications.  My Ant build file was getting pretty messy and I was continually commenting out files that I didn&#8217;t want to build.  By using an Ant macro and some uptodate trickery I was able to significantly decrease my build times when I am only updating files for a single application.  The macro also helped to make the build much more manageable.</p>

<p>You can find the whole build here:
<a href="http://flexapps.cvs.sourceforge.net/flexapps/census/build.xml?revision=1.14&amp;view=markup">http://flexapps.cvs.sourceforge.net/flexapps/census/build.xml?revision=1.14&view;=markup</a></p>

<p>First I setup a macro:</p>

<pre><code>  &lt;macrodef name="compileflex"&gt;
    &lt;attribute name="src"/&gt;
    &lt;attribute name="dest"/&gt;
    &lt;element name="uptodatefiles" optional="true"/&gt;
    &lt;sequential&gt;
      &lt;uptodate property="@{src}.uptodate" targetfile="@{dest}"&gt;
        &lt;srcfiles file="@{src}"/&gt;
        &lt;srcfiles file="build/base.swc"/&gt;
        &lt;srcfiles file="${src.flex.dir}/flex.css"/&gt;
        &lt;uptodatefiles/&gt;
      &lt;/uptodate&gt;
      &lt;antcall target="compilemxml"&gt;
        &lt;param name="src" value="@{src}"/&gt;
        &lt;param name="dest" value="@{dest}"/&gt;
      &lt;/antcall&gt;
    &lt;/sequential&gt;
  &lt;/macrodef&gt;
</code></pre>

<p>The macro calls the &#8220;compilemxml&#8221; target when the swf is not up-to-date.  The compilemxml target is a pretty plain Ant target:</p>

<pre><code>  &lt;target name="compilemxml" unless="${src}.uptodate"&gt;
    &lt;java jar="${flex.sdk.dir}/lib/mxmlc.jar" fork="true" maxmemory="128m"&gt;
      &lt;jvmarg value="-Dapplication.home=${flex.sdk.dir}"/&gt;
      &lt;arg value="-external-library-path+=build/base.swc"/&gt;
      &lt;arg value="-runtime-shared-libraries=base.swf"/&gt;
      &lt;arg value="-licenses.license" /&gt;
      &lt;arg value="charting"/&gt;
      &lt;arg value="${charting}"/&gt;
      &lt;arg value="-compiler.services" /&gt;
      &lt;arg value="etc/flex/services-config.xml" /&gt;
      &lt;arg value="-compiler.context-root" /&gt;
      &lt;arg value="/census" /&gt;
      &lt;arg value="-file-specs" /&gt;
      &lt;arg value="${src}" /&gt;
      &lt;arg value="-output" /&gt;
      &lt;arg value="${dest}" /&gt;
    &lt;/java&gt;
  &lt;/target&gt;
</code></pre>

<p>The macro is simple to use:</p>

<pre><code>  &lt;compileflex src="${src.flex.dir}/flex_soap_as.mxml" dest="build/census.war/flex_soap_as.swf"/&gt;
</code></pre>

<p>In that instance, the uptodate check will check the src file, the swc, and the css to see if they are uptodate.  If any of them were updated more recently than the swf, then compilemxml will be called.  If you have other unique files which need to also be checked, you can pass those in a uptodatefiles element:</p>

<pre><code>  &lt;compileflex src="${src.flex.dir}/index.mxml" dest="build/census.war/index.swf"&gt;
      &lt;uptodatefiles&gt;
        &lt;srcfiles file="${src.flex.dir}/Test.as"/&gt;
        &lt;srcfiles dir="${src.flex.dir}" includes="Wizard*"/&gt;
        &lt;srcfiles file="${src.flex.dir}/IFrame.mxml"/&gt;
        &lt;srcfiles file="${src.flex.dir}/BarItemRenderer.as"/&gt;
        &lt;srcfiles file="${src.flex.dir}/ChartBackgroundFill.as"/&gt;
        &lt;srcfiles file="${src.flex.dir}/ChartLegendCombo.mxml"/&gt;
        &lt;srcfiles file="${src.flex.dir}/CustomAxisRenderer.mxml"/&gt;
        &lt;srcfiles file="${src.flex.dir}/DataGridHeaderSeparator.as"/&gt;
      &lt;/uptodatefiles&gt;
    &lt;/compileflex&gt;
</code></pre>

<p>The one kinda-hack I had to do to make this work, was to make sure that the property which gets set by the uptodate task is unique for each time compileflex is called.  I used the ${src}.uptodate property name to accomplish this.</p>

<p>This build is pretty catered to my needs, however, you should be able to easily customize it to fit your needs.  I hope you find this useful.  Let me know if you have any questions!</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">James Ward</span></span>

      








  


<time datetime="2007-02-26T11:37:43-07:00" pubdate data-updated="true">Feb 26<span>th</span>, 2007</time>
      

<span class="categories">
  
    <a class='category' href='/categories/flex/'>Flex</a>, <a class='category' href='/categories/java/'>Java</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://jamesward.github.com/2007/02/26/reusable-ant-task-compile-flex-if-source-was-updated/" data-via="_JamesWard" data-counturl="http://jamesward.github.com/2007/02/26/reusable-ant-task-compile-flex-if-source-was-updated/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2007/02/21/how-i-overcame-my-fear-of-flash/" title="Previous Post: How I Overcame My Fear of Flash">&laquo; How I Overcame My Fear of Flash</a>
      
      
        <a class="basic-alignment right" href="/2007/02/28/eckel-flex-eseminar-buni-joins-javanet-twitter-addiction/" title="next Post: Eckel Flex eSeminar; Buni Joins java.net; Twitter Addiction">Eckel Flex eSeminar; Buni Joins java.net; Twitter Addiction &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    
<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("_JamesWard", 5, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/_JamesWard" class="twitter-follow-button" data-show-count="false">Follow @_JamesWard</a>
  
</section>


<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/101156657838073927919?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/jamesward">@jamesward</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'jamesward',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>

<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2011/12/12/heroku-jug-tour-boulder-phoenix-portland/">Heroku JUG Tour: Boulder, Phoenix, & Portland</a>
      </li>
    
      <li class="post">
        <a href="/2011/12/11/tutorial-play-framework-jpa-json-jquery-heroku/">Tutorial: Play Framework, JPA, JSON, jQuery, & Heroku</a>
      </li>
    
      <li class="post">
        <a href="/2011/11/30/using-mongodb-for-a-java-web-apps-httpsession/">Using MongoDB for a Java Web App's HttpSession</a>
      </li>
    
      <li class="post">
        <a href="/2011/11/30/heroku-java-user-group-tour-columbus-and-orange-county/">Heroku Java User Group Tour: Columbus and Orange County</a>
      </li>
    
      <li class="post">
        <a href="/2011/11/29/heroku-preso-from-devoxx-2011/">Heroku Preso from Devoxx 2011</a>
      </li>
    
  </ul>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2011 - James Ward -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'jamesward';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
