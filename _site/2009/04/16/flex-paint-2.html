<font color="red">UPDATE: I've created a <a href="http://www.jamesward.com/2010/03/22/flex-paint-updated-to-flex-4/">new version of Flex Paint</a> with Flex 4.</font>

It's surprising and somewhat humbling to find out which of my blog posts are the most popular.  There are some posts that I spend days on and they end up only being read by a few people.  Then there are others that are simple, short, and to be honest kinda boring that end up being read by tons of people.  My original <a href="http://www.jamesward.com/blog/2006/08/16/flex-paint-flex-display-object-to-png/">Flex Paint blog</a> is one of those simple, short but highly viewed blogs.  I would never have thought that out of all my blog posts that one would be read by so many.  Since it's almost two years old and presumably being used as a reference by many people, I thought it would be useful to update it to use the new Flash Player 10 <a href="http://livedocs.adobe.com/flex/3/langref/flash/net/FileReference.html">FileReference API</a> to eliminate the need to send the image to the server.

Here is the new version:
<iframe src="/demos/FlexPaint2/FlexPaint2.html" width="330" height="385" style="border:0px"></iframe>
(<a href="/demos/FlexPaint2/srcview/index.html">source code</a>)

Saving the drawn image with Flash Player 10 is as simple as:
<pre lang="ActionScript">        var bd:BitmapData = new BitmapData(canvas.width,canvas.height);
        bd.draw(canvas);
  
        var ba:ByteArray = (new PNGEncoder()).encode(bd);
        
        (new FileReference()).save(ba, "doodle.png");</pre>

This reads the image client-side, encodes it, and then initiates a save dialog.  Pretty simple stuff.  The only downside is that using this new code I'll no longer get to see the amazing things that people are drawing.  Here are some of the most interesting drawings people made with the old version:
<table style="border-width: 1px">
  <tr>
    <td style="border-width: 1px; border-style: solid;"><img src="/demos/FlexPaint/1229473134284.png"/></td>
    <td style="border-width: 1px; border-style: solid;"><img src="/demos/FlexPaint/1231944828597.png"/></td>
  </tr>
  <tr>
    <td style="border-width: 1px; border-style: solid;"><img src="/demos/FlexPaint/1232093014444.png"/></td>
    <td style="border-width: 1px; border-style: solid;"><img src="/demos/FlexPaint/1232118713440.png"/></td>
  </tr>
  <tr>
    <td style="border-width: 1px; border-style: solid;"><img src="/demos/FlexPaint/1232336233020.png"/></td>
    <td style="border-width: 1px; border-style: solid;"><img src="/demos/FlexPaint/1234263678780.png"/></td>
  </tr>
  <tr>
    <td style="border-width: 1px; border-style: solid;"><img src="/demos/FlexPaint/1234597589351.png"/></td>
    <td style="border-width: 1px; border-style: solid;"><img src="/demos/FlexPaint/1238344083132.png"/></td>
  </tr>
</table>

Let me know what you think about the new version!
